<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Fair Team Picker</title>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@500;700&family=Open+Sans:wght@400;600&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Open Sans', sans-serif;
      margin: 20px;
      background-color: #f8f9fa;
    }

    h1, h2 {
      font-family: 'Montserrat', sans-serif;
    }

    h1 {
      text-align: center;
      margin-bottom: 30px;
      color: #2c3e50;
    }

    .zones {
      display: flex;
      justify-content: space-between;
      gap: 20px;
      margin-top: 20px;
    }

    .zone {
      background: linear-gradient(135deg, #ffffff 0%, #f9f9f9 100%);
      padding: 20px;
      border-radius: 12px;
      width: 32%;
      box-shadow: 0 6px 15px rgba(0,0,0,0.08);
      border-left: 4px solid;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    #zoneA { border-left-color: #4285F4; }
    #zoneB { border-left-color: #34A853; }
    #zoneC { border-left-color: #FBBC05; }

    .zone:hover {
      transform: translateY(-3px);
      box-shadow: 0 10px 20px rgba(0,0,0,0.12);
    }

    .zone h2 {
      text-align: center;
      margin-top: 0;
      padding-bottom: 10px;
      border-bottom: 2px solid #eee;
    }

    .member {
      padding: 12px 15px;
      border-bottom: 1px solid #eee;
      transition: all 0.2s;
      cursor: pointer;
      margin: 5px 0;
      border-radius: 4px;
    }

    .member:hover {
      background-color: #f5f5f5;
    }

    .participant-line {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .team-name {
      font-size: 12px;
      font-weight: bold;
      margin-left: 10px;
      padding: 3px 8px;
      border-radius: 10px;
      background-color: #f0f0f0;
    }

    .btn-wrapper {
      text-align: center;
      margin: 30px 0;
      display: flex;
      justify-content: center;
      gap: 15px;
    }

    button {
      padding: 10px 25px;
      font-size: 16px;
      background-color: #2c3e50;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s;
      font-family: 'Montserrat', sans-serif;
    }

    button:hover:not(:disabled) {
      background-color: #1a252f;
      transform: translateY(-2px);
    }

    button:disabled {
      opacity: 0.7;
      cursor: not-allowed;
    }

    .team-buttons {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 10px;
      margin-bottom: 20px;
    }

    .team-button {
      padding: 8px 15px;
      font-size: 14px;
      border-radius: 20px;
      cursor: pointer;
      border: 2px solid white;
      color: white;
      font-weight: bold;
      position: relative;
      transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
      font-family: 'Montserrat', sans-serif;
    }

    .team-button:hover:not(:disabled) {
      transform: scale(1.05);
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
    }

    .team-button.revealed {
      opacity: 0.7;
      transform: scale(0.95);
      padding-right: 30px;
    }

    .team-button.revealed::after {
      content: "‚úì";
      position: absolute;
      right: 10px;
      top: 50%;
      transform: translateY(-50%);
    }

    .hidden-member {
      color: transparent;
      text-shadow: 0 0 8px rgba(0,0,0,0.5);
    }

    .hidden-team {
      color: transparent;
      text-shadow: 0 0 5px rgba(0,0,0,0.3);
    }

    .revealed-info {
      font-weight: bold;
      color: #000;
    }

    .current-reveal {
      background-color: #fffacd;
      border-radius: 4px;
      padding: 2px 4px;
      box-shadow: 0 0 0 2px rgba(255,200,50,0.5);
    }

    .seat-number {
      display: inline-block;
      width: 25px;
      color: #7f8c8d;
      font-weight: normal;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(5px); }
      to { opacity: 1; transform: translateY(0); }
    }

    @media (max-width: 768px) {
      .zones {
        flex-direction: column;
      }
      .zone {
        width: 100%;
        margin-bottom: 20px;
      }
      .btn-wrapper {
        flex-direction: column;
        align-items: center;
      }
    }
  </style>
</head>
<body>

<h1>üéØ ·É°·Éê·É•·Éê·É†·Éó·Éï·Éî·Éö·Éù·É° ·Éó·Éê·É°·Éò 2025</h1>

<div class="team-buttons" id="teamButtons"></div>

<div class="zones">
  <div id="zoneA" class="zone"><h2>Zone A</h2></div>
  <div id="zoneB" class="zone"><h2>Zone B</h2></div>
  <div id="zoneC" class="zone"><h2>Zone C</h2></div>
</div>

<div class="btn-wrapper">
  <button id="randomizeBtn" onclick="handleRandomize()">üîÑ Randomize</button>
  <button id="resetBtn" onclick="handleReset()">‚ôª Reset Reveals</button>
  <button onclick="exportToPNG()">üì∑ Export to PNG</button>
</div>

<script>
  const participants = {
    "Fishbusters": ["·ÉØ·Éê·Éë·Éê ·Éõ·Éù·É°·É£·Éö·Éò·É®·Éï·Éò·Éö·Éò", "·Éú·Éò·Éô·É£·É®·Éê ·É°·É£·ÉÆ·Éò·É®·Éï·Éò·Éö·Éò", "·Éï·Éê·Éü·Éê ·Éô·Éï·Éò·É†·Éò·Éô·Éê·É®·Éï·Éò·Éö·Éò"],
    "Quinto": ["·Éí·Éò·Éù·É†·Éí·Éò ·Éõ·Éê·É¢·É£·Éê·É®·Éï·Éò·Éö·Éò", "·Éï·Éî·É§·ÉÆ·Éï·Éò·Éê ·É•·Éù·Éë·Éê·Éö·Éò·Éê", "·Éõ·Éò·É®·Éò·Éô·Éù ·É•·Éù·Éë·Éê·Éö·Éò·Éê"],
    "Maver Club Georgia 1": ["·Éò·É†·Éê·Éô·Éö·Éò ·É°·É£·Éö·Éê·Éë·Éî·É†·Éò·É´·Éî", "·Éõ·Éê·Éö·ÉÆ·Éê·Éñ ·Éô·Éê·Éú·Éô·Éê·É´·Éî", "·Éí·Éù·Éí·Éê ·ÉÆ·Éò·Éô·Éö·Éê·Éú·É´·Éî"],
    "Maver Club Georgia 2": ["·Éê·É©·Éò·Éô·Éù ·Éô·Éê·Éû·Éê·Éú·Éê·É´·Éî", "·Éö·É£·Éô·Éê ·É¶·Éï·Éò·Éú·Éò·Éê·É®·Éï·Éò·Éö·Éò", "·Éû·Éê·Éï·Éî·Éö ·É®·Éò·É®·Éê·Éî·Éï·Éò"],
    "Maver Club Georgia 3": ["·Éñ·É£·É†·Éê ·Éõ·Éê·É≠·Éê·É†·Éê·É®·Éï·Éò·Éö·Éò", "·Éú·É£·Éô·É†·Éò ·Éú·Éù·Éñ·Éê·É´·Éî", "·Éë·Éî·É•·Éê ·Éë·Éê·É®·Éò·Éú·É£·É†·Éò·É´·Éî"],
    "FeederLab 1": ["·Éì·Éê·Éó·É£·Éú·Éê ·Éò·Éõ·Éê·É´·Éî", "·É†·Éî·Éñ·Éò ·Éú·Éê·É≠·Éß·Éî·Éë·Éò·Éê", "·Éõ·Éò·ÉÆ·Éù ·Éô·Éê·ÉÆ·Éî·Éó·Éî·Éö·Éò·É´·Éî"],
    "FeederLab 2": ["·Éí·Éò·Éí·Éê ·Éí·Éê·Éë·É†·Éò·Éê·É´·Éî", "·Éñ·É£·É†·Éê ·Éõ·Éî·É†·Éî·Éô·Éö·Éò·É®·Éï·Éò·Éö·Éò", "·Éì·Éê·Éï·Éò·Éó ·É°·Éê·Éõ·É°·Éù·Éú·Éò·É´·Éî"],
    "FishFinder 1": ["·Éò·Éù·É°·Éî·Éë ·Éû·Éê·É¢·Éê·É¢·Éò·É®·Éï·Éò·Éö·Éò", "·Éö·Éê·É®·Éê ·ÉØ·Éê·Éú·Éê·É®·Éò·Éê", "·Éú·Éò·Éô·Éù·Éö·Éù·Éñ ·ÉØ·Éê·Éï·Éê·ÉÆ·Éò·É®·Éï·Éò·Éö·Éò"],
    "FishFinder 2": ["·Éú·Éò·Éô·Éù·Éö·Éù·Éñ ·Éô·Éê·É®·Éò·Éê", "·Éö·Éê·É®·Éê ·Éì·Éê·É†·É©·Éò·Éê·É®·Éï·Éò·Éö·Éò", "·Éû·Éê·Éê·É¢·Éê ·ÉÆ·Éï·Éò·É°·É¢·Éê·Éú·Éò"],
    "Black Pearl": ["·Éî·Éì·Éï·Éê·É†·Éì·É° ·É§·Éî·Éò·É•·É†·Éò·É®·Éï·Éò·Éö·Éò", "·Éò·Éù·É°·Éî·Éë ·Éë·Éò·É¢·Éë·É£·Éú·Éù·Éï·Éò", "·Éí·Éò·Éù·É†·Éí·Éò ·Éë·Éê·É†·Éú·Éù·Éï·Éò"],
    "Individual": ["·Éì·Éê·Éï·Éò·Éó ·Éô·Éê·É®·Éò·Éê", "·Éö·Éê·É®·Éê ·Éë·É£·Éö·Éê·É®·Éò", "·Éò·Éê·Éú ·É∞·Éò·Éô·Éõ·Éê·Éú·Éò"]
  };

  const teamColors = {
    "Fishbusters": "#E53935",
    "Quinto": "#1E88E5",
    "Maver Club Georgia 1": "#8E24AA",
    "Maver Club Georgia 2": "#F4511E",
    "Maver Club Georgia 3": "#D81B60",
    "FeederLab 1": "#FFB300",
    "FeederLab 2": "#43A047",
    "FishFinder 1": "#00ACC1",
    "FishFinder 2": "#7CB342",
    "Black Pearl": "#3949AB",
    "Individual": "#FB8C00"
  };

  let currentAssignment = null;
  const revealedTeams = new Set();
  let hasRevealed = false;
  let currentHighlightedTeam = null;

  function fisherYates(array) {
    for (let i = array.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [array[i], array[j]] = [array[j], array[i]];
    }
    return array;
  }

  function constrainedRandomAssignment() {
    const teams = Object.entries(participants);
    const zoneLists = { A: [], B: [], C: [] };
    const maxPerZone = 11;

    let allMembers = [];
    for (const [team, members] of teams) {
      members.forEach(member => allMembers.push({ name: member, team }));
    }

    fisherYates(allMembers);

    const zoneKeys = ["A", "B", "C"];
    const zoneTeamTracker = { A: new Set(), B: new Set(), C: new Set() };

    for (const member of allMembers) {
      const shuffledZones = fisherYates([...zoneKeys]);
      for (const zone of shuffledZones) {
        if (zoneLists[zone].length < maxPerZone && !zoneTeamTracker[zone].has(member.team)) {
          zoneLists[zone].push(member);
          zoneTeamTracker[zone].add(member.team);
          break;
        }
      }
    }

    return zoneLists;
  }

  function handleRandomize() {
    if (hasRevealed) {
      const confirmReset = confirm("You've already revealed some teams. Randomizing again will reset everything. Continue?");
      if (!confirmReset) return;
    }
    generateDraw();
  }

  function handleReset() {
    revealedTeams.clear();
    hasRevealed = false;
    currentHighlightedTeam = null;
    updateTeamButtons();
    updateAllZones();
    document.getElementById("randomizeBtn").disabled = false;
  }

  function generateDraw() {
    currentAssignment = constrainedRandomAssignment();
    handleReset(); // Reset reveals when generating new draw
    updateAllZones();
  }

  function updateAllZones() {
    updateZone("zoneA", currentAssignment.A, "A", 1, false);
    updateZone("zoneB", currentAssignment.B, "B", 12, false);
    updateZone("zoneC", currentAssignment.C, "C", 23, false);
    setTimeout(setupMemberClickHandlers, 100);
  }

  function updateZone(zoneId, members, label, startNumber, showTeamInfo) {
    const zone = document.getElementById(zoneId);
    let html = `<h2>Zone ${label}</h2>`;
    members.forEach((member, i) => {
      const color = teamColors[member.team] || "#888";
      const showInfo = showTeamInfo || revealedTeams.has(member.team);
      const isCurrentlyHighlighted = member.team === currentHighlightedTeam;
      
      html += `
        <div class="member" data-team="${member.team}">
          <div class="participant-line">
            <span>
              <span class="seat-number">${startNumber + i}.</span>
              ${showInfo ? 
                `<span class="revealed-info ${isCurrentlyHighlighted ? 'current-reveal' : ''}" style="color: ${color}">${member.name}</span>` : 
                `<span class="hidden-member">${member.name}</span>`}
            </span>
            <span class="team-name" style="background-color: ${color}20; border: 1px solid ${color}80">
              ${showInfo ? 
                `<span class="revealed-info ${isCurrentlyHighlighted ? 'current-reveal' : ''}">${member.team}</span>` : 
                `<span class="hidden-team">${member.team}</span>`}
            </span>
          </div>
        </div>`;
    });
    zone.innerHTML = html;
  }

  function updateTeamButtons() {
    const teamButtonsContainer = document.getElementById("teamButtons");
    teamButtonsContainer.innerHTML = "";
    
    Object.keys(participants).forEach(team => {
      const button = document.createElement("button");
      button.className = `team-button ${revealedTeams.has(team) ? 'revealed' : ''}`;
      button.textContent = team;
      button.style.backgroundColor = teamColors[team] || "#888";
      button.onclick = () => toggleTeamVisibility(team);
      button.disabled = revealedTeams.has(team);
      
      teamButtonsContainer.appendChild(button);
    });
  }

  function toggleTeamVisibility(team) {
    if (!revealedTeams.has(team)) {
      revealedTeams.add(team);
      hasRevealed = true;
      currentHighlightedTeam = team;
      
      document.querySelectorAll(`.member`).forEach(el => {
        if (el.dataset.team === team) {
          el.style.animation = 'fadeIn 0.5s ease-out';
        }
      });
      
      document.getElementById("randomizeBtn").disabled = true;
    }
    currentHighlightedTeam = revealedTeams.has(team) ? team : null;
    updateTeamButtons();
    updateAllZones();
  }

  function setupMemberClickHandlers() {
    document.querySelectorAll('.member').forEach(member => {
      member.addEventListener('click', function() {
        const teamName = this.dataset.team;
        if (teamName && !revealedTeams.has(teamName)) {
          revealedTeams.add(teamName);
          this.style.animation = 'fadeIn 0.5s ease-out';
          updateTeamButtons();
          updateAllZones();
        }
      });
    });
  }

  function exportToPNG() {
    // Create a temporary div to hold everything we want to export
    const exportDiv = document.createElement('div');
    exportDiv.style.padding = '20px';
    exportDiv.style.backgroundColor = 'white';
    
    // Add title
    const title = document.createElement('h1');
    title.textContent = document.querySelector('h1').textContent;
    title.style.textAlign = 'center';
    exportDiv.appendChild(title);
    
    // Add team buttons
    const buttonsDiv = document.createElement('div');
    buttonsDiv.className = 'team-buttons';
    Array.from(document.querySelectorAll('.team-button')).forEach(btn => {
      const clone = btn.cloneNode(true);
      clone.style.margin = '5px';
      buttonsDiv.appendChild(clone);
    });
    exportDiv.appendChild(buttonsDiv);
    
    // Add zones
    const zonesDiv = document.createElement('div');
    zonesDiv.className = 'zones';
    zonesDiv.style.marginTop = '20px';
    Array.from(document.querySelectorAll('.zone')).forEach(zone => {
      const clone = zone.cloneNode(true);
      zonesDiv.appendChild(clone);
    });
    exportDiv.appendChild(zonesDiv);
    
    // Add to body temporarily
    document.body.appendChild(exportDiv);
    
    // Use html2canvas to capture
    html2canvas(exportDiv, {
      scale: 2,
      logging: false,
      useCORS: true
    }).then(canvas => {
      const link = document.createElement('a');
      link.download = 'team-distribution.png';
      link.href = canvas.toDataURL('image/png');
      link.click();
      
      // Remove temporary div
      document.body.removeChild(exportDiv);
    });
  }

  // Initialize the page
  generateDraw();
</script>
<script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
</body>
</html>